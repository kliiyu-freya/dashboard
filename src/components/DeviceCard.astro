---
interface Props {
  device: {
    id: string;
    name: string;
    type: string;
    state: string;
  };
}

const { device } = Astro.props;
---

<div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
  <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">
    {device.name}
  </h3>
  <p class="text-gray-500 dark:text-gray-400 mb-4">
    Type: {device.type}
  </p>
  <div class="flex items-center justify-between">
    <span class="text-sm font-medium text-gray-900 dark:text-white">
      Status: {device.state}
    </span>
    <button
      data-device-id={device.id}
      class="toggle-device bg-purple-600 hover:bg-purple-700 text-white font-medium py-2 px-4 rounded-lg transition-colors"
    >
      Toggle
    </button>
  </div>
</div>

<script>
  import { sendCommand } from '../stores/websocket';

  document.querySelectorAll('.toggle-device').forEach((button) => {
    button.addEventListener('click', () => {
      const deviceId = button.getAttribute('data-device-id');
      if (deviceId) {
        sendCommand(deviceId, 'toggle');
      }
    });
  });
</script>